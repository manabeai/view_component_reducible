module ViewComponentReducible
  VERSION: String
  def self.registry: () -> Hash[String, Class]
  def self.register: (Class component_klass) -> void
  def self.config: () -> Configuration
  def self.configure: () { (Configuration) -> void } -> void

  class Configuration
    attr_accessor adapter: Class
    attr_accessor secret: String?
    attr_accessor redis: untyped
    attr_accessor redis_url: String?
    attr_accessor redis_ttl: Integer?
    attr_accessor redis_namespace: String?
    def initialize: () -> void
    def adapter_for: (ActionController::Base controller, ?adapter_class: Class) -> Adapter::Base
  end

  class Msg < Struct
    attr_accessor type: (String | Symbol)
    attr_accessor payload: untyped
    def self.from_params: (Hash[untyped, untyped] params) -> Msg
    def self.build: (type: String | Symbol, ?payload: untyped) -> Msg
  end
  module Component
    def self.included: (untyped base) -> void
    def vcr_envelope: () -> Hash[untyped, untyped]?
    def vcr_state_token: () -> String?
    def vcr_state: () -> untyped
    def state: () -> untyped
    def vcr_dom_id: (path: String) -> String
    def vcr_button_to: (?String, msg_type: String, ?state: String?, ?msg_payload: Hash[untyped, untyped] | String, ?target_path: String?, ?url: String, ?button_attrs: Hash[untyped, untyped]) { () -> untyped } -> String
    def vcr_dispatch_form: (?String, msg_type: String, ?state: String?, ?msg_payload: Hash[untyped, untyped] | String, ?target_path: String?, ?url: String, ?button_attrs: Hash[untyped, untyped]) { () -> untyped } -> String
    def emit: (String | Symbol type, ?Hash[untyped, untyped] payload) -> Proc
    def render_in: (ActionView::Base view_context) { () -> untyped } -> String

    module ClassMethods
      def vcr_id: () -> String
      def state: () { () -> void } -> void
      def vcr_state_schema: () -> State::Schema
    end
  end

  module Adapter
    class Base
      def self.state_param_name: () -> String
      def initialize: (secret: String, **untyped) -> void
      def dump: (Hash[untyped, untyped] envelope, request: ActionDispatch::Request) -> String
      def load: (request: ActionDispatch::Request) -> Hash[untyped, untyped]
    end

    class HiddenField < Base
      def verifier: () -> ActiveSupport::MessageVerifier
      def dump: (Hash[untyped, untyped] envelope, request: ActionDispatch::Request) -> String
    end

    class Session < Base
      def verifier: () -> ActiveSupport::MessageVerifier
    end

    class Redis < Base
      DEFAULT_TTL: Integer
      DEFAULT_NAMESPACE: String
      def verifier: () -> ActiveSupport::MessageVerifier
    end
  end

  module State
    class Schema
      Field: Struct

      def initialize: () -> void
      def add_field: (Symbol name, default: untyped) -> void
      def data_class: () -> Class
      def build: (Hash[untyped, untyped] state_hash) -> Hash[String, untyped]
      def build_data: (Hash[untyped, untyped] state_hash) -> untyped
      def defaults: () -> Hash[String, untyped]
    end

    module DSL
      def self.included: (untyped base) -> void

      module ClassMethods
        def state: () { () -> void } -> void
        def vcr_state_schema: () -> Schema
      end
    end

    class Envelope
      def self.initial: (untyped root_component_klass, ?path: String) -> Hash[String, untyped]
    end
  end
  class Runtime
    MAX_EFFECT_STEPS: Integer
    def call: (envelope: Hash[untyped, untyped], msg: Msg, target_path: String, controller: ActionController::Base) -> [Hash[untyped, untyped], String]
    def render_target: (envelope: Hash[untyped, untyped], target_path: String, controller: ActionController::Base) -> String
    def debug_chain: () -> Array[String]?
  end

  module Dispatch
    def self.inject_state: (String html, String signed_state) -> String
  end

  class DispatchController < ActionController::Base
    def self.vcr_adapter: (?Class adapter_class) -> Class?
    def call: () -> void
  end

  class Engine < ::Rails::Engine
  end

  class Railtie < ::Rails::Railtie
  end

  module Helpers
    def vcr_boundary: (path: String) { () -> untyped } -> String
    def vcr_button_to: (?state: String?, msg_type: String, ?msg_payload: Hash[untyped, untyped] | String, ?target_path: String?, ?url: String) { () -> untyped } -> String
    def vcr_dispatch_form: (?state: String?, msg_type: String, ?msg_payload: Hash[untyped, untyped] | String, ?target_path: String?, ?url: String) { () -> untyped } -> String
    def vcr_dispatch_script_tag: () -> String
    def vcr_debug_bar_tag: () -> String
  end
  # See the writing guide of rbs: https://github.com/ruby/rbs#guides
end
